// "use client";
// import { useRouter } from "next/navigation";
// import { Trash2 } from "lucide-react";
// import { useEffect, useState, useMemo } from "react";
// import {
//   AlertDialog,
//   AlertDialogAction,
//   AlertDialogCancel,
//   AlertDialogContent,
//   AlertDialogDescription,
//   AlertDialogFooter,
//   AlertDialogHeader,
//   AlertDialogTitle,
//   AlertDialogTrigger,
// } from "@/components/ui/alert-dialog";
// import { Button } from "@/components/ui/button";
// import { ScrollArea } from "@/components/ui/scroll-area";
// import { useCartStore } from "@/store/cartStore";
// import { motion, AnimatePresence } from "framer-motion";

// export default function CartPage() {
//   const { getTotalItems, getTotalPrice, cart, removeItem, updateQuantity } =
//     useCartStore();
//   const [mounted, setMounted] = useState(false);
//   const [notifications, setNotifications] = useState<
//     { id: string; message: string; type: "success" | "error" }[]
//   >([]);
//   useEffect(() => {
//     setMounted(true);
//   }, []);
//   const router = useRouter();

//   // Calculate total with tax
//   const totalWithTax = useMemo(() => {
//     const total = getTotalPrice();
//     return total + total * 0.15;
//   }, [cart]);

//   // Format currency
//   const formatCurrency = (value: number): string =>
//     new Intl.NumberFormat("ar-SA", {
//       style: "currency",
//       currency: "SAR",
//     }).format(value);

//   if (!mounted) return null;

//   return (
//     <div className="p-6 dark:bg-gray-900 dark:text-white min-h-screen flex flex-col items-center">
//       {/* Desktop Notification */}
//       <div className="w-full max-w-6xl mx-auto mb-4">
//         <AnimatePresence>
//           {notifications.map(({ id, message, type }) => (
//             <motion.div
//               key={id}
//               initial={{ opacity: 0, y: -20 }}
//               animate={{ opacity: 1, y: 0 }}
//               exit={{ opacity: 0, y: -20 }}
//               transition={{ duration: 0.3 }}
//               className={`w-full ${
//                 type === "success"
//                   ? "bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200"
//                   : "bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200"
//               } text-sm font-medium px-4 py-2 rounded-md mb-2 shadow-md`}
//             >
//               {message}
//             </motion.div>
//           ))}
//         </AnimatePresence>
//       </div>

//       <h1 className="text-2xl font-bold mb-6 text-center">ğŸ›’ Ù…Ù„Ø®Øµ Ø§Ù„Ø³Ù„Ø©</h1>
//       {getTotalItems() === 0 ? (
//         <div className="flex flex-col items-center justify-center h-[300px] space-y-4 text-center">
//           <Trash2 size={64} className="text-gray-300" />
//           <h3 className="text-lg font-semibold text-gray-800 dark:text-white">
//             Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹
//           </h3>
//           <p className="text-sm text-gray-500 dark:text-gray-400">
//             Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†!
//           </p>
//           <Button
//             className="bg-blue-600 text-white hover:bg-blue-700 transition"
//             onClick={() => router.push("/catalog")}
//           >
//             ØªØµÙØ­ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
//           </Button>
//         </div>
//       ) : (
//         <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-[2fr_1fr] gap-6 w-full max-w-6xl">
//           <ScrollArea className="h-[400px] border rounded-lg p-4 w-full">
//             <div className="space-y-4">
//               {Object.values(cart).map(({ product, quantity }, index) => {
//                 const uniqueKey = `${product.id}-${quantity}-${index}`; // Ensure unique key
//                 return (
//                   <div
//                     key={uniqueKey}
//                     className="flex flex-col sm:flex-row justify-between items-center border-b pb-4 gap-4"
//                   >
//                     <div className="flex flex-col sm:flex-row gap-4 items-center w-full sm:w-auto">
//                       <img
//                         loading="lazy"
//                         src={product.imageUrl}
//                         alt={product.name}
//                         className="w-20 h-20 object-cover rounded-md"
//                       />
//                       <div className="text-center sm:text-left">
//                         <p className="font-semibold">{product.name}</p>
//                         <p className="text-sm text-gray-500 dark:text-gray-400">
//                           {formatCurrency(product.price)}
//                         </p>
//                       </div>
//                     </div>
//                     <div className="flex flex-col sm:flex-row items-center gap-4">
//                       <div className="flex items-center gap-1 border border-gray-300 rounded-md overflow-hidden">
//                         <Button
//                           variant="outline"
//                           size="icon"
//                           onClick={() => {
//                             updateQuantity(product.id, -1);
//                             // Add sad face notification
//                             const notificationId = `${
//                               product.id
//                             }-remove-${Date.now()}`;
//                             setNotifications((prev) => [
//                               ...prev,
//                               {
//                                 id: notificationId,
//                                 message: `ğŸ˜¢ ØªÙ… ØªÙ‚Ù„ÙŠÙ„ "${product.name}"`,
//                                 type: "error",
//                               },
//                             ]);
//                             setTimeout(() => {
//                               setNotifications((prev) =>
//                                 prev.filter((n) => n.id !== notificationId)
//                               );
//                             }, 3000); // Hide notification after 3 seconds
//                           }}
//                           disabled={quantity <= 1}
//                           className="w-8 h-8 text-sm p-0 hover:bg-gray-100"
//                         >
//                           -
//                         </Button>
//                         <span className="px-2 text-sm font-medium text-gray-700 dark:text-white">
//                           {quantity}
//                         </span>
//                         <Button
//                           variant="outline"
//                           size="icon"
//                           onClick={() => {
//                             updateQuantity(product.id, 1);
//                             // Add smile face notification
//                             const notificationId = `${
//                               product.id
//                             }-add-${Date.now()}`;
//                             setNotifications((prev) => [
//                               ...prev,
//                               {
//                                 id: notificationId,
//                                 message: `ğŸ˜Š ØªÙ… Ø¥Ø¶Ø§ÙØ© "${product.name}"`,
//                                 type: "success",
//                               },
//                             ]);
//                             setTimeout(() => {
//                               setNotifications((prev) =>
//                                 prev.filter((n) => n.id !== notificationId)
//                               );
//                             }, 3000); // Hide notification after 3 seconds
//                           }}
//                           className="w-8 h-8 text-sm p-0 hover:bg-gray-100"
//                         >
//                           +
//                         </Button>
//                       </div>
//                       <p className="font-semibold">
//                         {formatCurrency(product.price * quantity)}
//                       </p>
//                       <AlertDialog>
//                         <AlertDialogTrigger asChild>
//                           <Button
//                             variant="outline"
//                             size="icon"
//                             className="text-red-500 border-red-500 hover:bg-red-100"
//                           >
//                             <Trash2 size={16} />
//                           </Button>
//                         </AlertDialogTrigger>
//                         <AlertDialogContent>
//                           <AlertDialogHeader>
//                             <AlertDialogTitle>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ</AlertDialogTitle>
//                             <AlertDialogDescription>
//                               Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ "{product.name}" Ù…Ù† Ø§Ù„Ø³Ù„Ø©ØŸ
//                             </AlertDialogDescription>
//                           </AlertDialogHeader>
//                           <AlertDialogFooter>
//                             <AlertDialogCancel>Ø¥Ù„ØºØ§Ø¡</AlertDialogCancel>
//                             <AlertDialogAction
//                               onClick={() => removeItem(product.id)}
//                               className="bg-red-600 hover:bg-red-700"
//                             >
//                               Ø­Ø°Ù
//                             </AlertDialogAction>
//                           </AlertDialogFooter>
//                         </AlertDialogContent>
//                       </AlertDialog>
//                     </div>
//                   </div>
//                 );
//               })}
//             </div>
//           </ScrollArea>
//           {/* Summary Section */}
//           <motion.div
//             className="sticky top-20 bg-gray-50 dark:bg-gray-800 p-6 rounded-lg shadow-lg space-y-4 w-full max-w-sm self-start"
//             initial={{ opacity: 0, y: 20 }}
//             animate={{ opacity: 1, y: 0 }}
//             transition={{ duration: 0.5 }}
//           >
//             <h2 className="text-lg font-bold text-center">Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨</h2>
//             <div className="flex justify-between items-center">
//               <span className="flex items-center gap-2 text-gray-600 dark:text-gray-400">
//                 <svg
//                   xmlns="http://www.w3.org/2000/svg"
//                   fill="none"
//                   viewBox="0 0 24 24"
//                   strokeWidth={1.5}
//                   stroke="currentColor"
//                   className="w-5 h-5"
//                 >
//                   <path
//                     strokeLinecap="round"
//                     strokeLinejoin="round"
//                     d="M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 01-1.12-1.243l1.264-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.119 1.007zM8.625 10.5a.375.375 0 11-.75 0 .375.375 0 01.75 0zm7.5 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"
//                   />
//                 </svg>
//                 Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ±Ø¹ÙŠ:
//               </span>
//               <span className="font-semibold">
//                 {formatCurrency(getTotalPrice())}
//               </span>
//             </div>
//             <div className="flex justify-between items-center">
//               <span className="flex items-center gap-2 text-gray-600 dark:text-gray-400">
//                 <svg
//                   xmlns="http://www.w3.org/2000/svg"
//                   fill="none"
//                   viewBox="0 0 24 24"
//                   strokeWidth={1.5}
//                   stroke="currentColor"
//                   className="w-5 h-5"
//                 >
//                   <path
//                     strokeLinecap="round"
//                     strokeLinejoin="round"
//                     d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
//                   />
//                 </svg>
//                 Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ (15%):
//               </span>
//               <span className="font-semibold">
//                 {formatCurrency(getTotalPrice() * 0.15)}
//               </span>
//             </div>
//             <div className="flex justify-between items-center">
//               <span className="flex items-center gap-2 text-gray-600 dark:text-gray-400">
//                 <svg
//                   xmlns="http://www.w3.org/2000/svg"
//                   fill="none"
//                   viewBox="0 0 24 24"
//                   strokeWidth={1.5}
//                   stroke="currentColor"
//                   className="w-5 h-5"
//                 >
//                   <path
//                     strokeLinecap="round"
//                     strokeLinejoin="round"
//                     d="M15 8.25H9m6 3H9m3 6l-3-3h1.5a3 3 0 100-6M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
//                   />
//                 </svg>
//                 Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:
//               </span>
//               <span className="font-bold text-lg">
//                 {formatCurrency(totalWithTax)}
//               </span>
//             </div>
//           </motion.div>
//         </div>
//       )}

//       {/* Sticky Footer */}
//       <div className="fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-900 shadow-lg p-4 flex justify-center z-50">
//         <Button
//           className="w-full max-w-md bg-blue-600 text-white hover:bg-blue-700 transition"
//           onClick={() => router.push("/checkout")}
//         >
//           Ù…ØªØ§Ø¨Ø¹Ø© Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡
//         </Button>
//       </div>
//     </div>
//   );
// }